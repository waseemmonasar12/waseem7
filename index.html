<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Ø®Ø¯Ù…Ø© Ø±Ø³Ø§Ø¦Ù„ Ù…Ø´ÙØ±Ø© Ø¢Ù…Ù†Ø© - Ø§Ù„ØªØ´ÙÙŠØ± ÙŠØªÙ… Ø·Ø±ÙÙŠÙ‹Ø§ ÙˆÙ„Ø§ ÙŠØ®Ø²Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ±">
  <title>ğŸ”’ Ø¢Ù…Ù† - Ù…Ø±Ø§Ø³Ù„Ø© Ù…Ø´ÙØ±Ø© Ø·Ø±ÙÙŠÙ‹Ø§</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { 
      box-sizing: border-box; 
      margin: 0;
      padding: 0;
    }
    
    :root {
      --primary: #2563eb;
      --primary-dark: #1d4ed8;
      --secondary: #dc2626;
      --secondary-dark: #b91c1c;
      --success: #10b981;
      --warning: #f59e0b;
      --dark: #1e293b;
      --light: #f8fafc;
      --gray: #64748b;
      --border: #e2e8f0;
      --shadow: 0 10px 25px rgba(0,0,0,0.08);
      --radius: 16px;
      --transition: all 0.3s ease;
    }
    
    body {
      font-family: 'Segoe UI', 'Cairo', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f0f9ff 0%, #fef7ff 100%);
      color: var(--dark);
      min-height: 100vh;
      padding: 20px;
      direction: rtl;
      line-height: 1.7;
    }
    
    .container {
      max-width: 850px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      text-align: center;
      margin-bottom: 30px;
      padding: 30px;
      background: white;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }
    
    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .logo-icon {
      font-size: 3rem;
      color: var(--primary);
      background: linear-gradient(135deg, var(--primary), #60a5fa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    h1 {
      font-size: 1.8rem;
      color: var(--dark);
      margin-bottom: 10px;
    }
    
    .subtitle {
      color: var(--gray);
      font-size: 1rem;
      margin-bottom: 20px;
    }
    
    .motto {
      font-style: italic;
      color: var(--primary);
      font-weight: 600;
      padding: 15px;
      border-right: 4px solid var(--primary);
      background-color: rgba(37, 99, 235, 0.08);
      border-radius: 10px;
      margin-top: 15px;
      display: inline-block;
    }
    
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 25px 0;
    }
    
    .feature {
      background: white;
      padding: 20px;
      border-radius: var(--radius);
      text-align: center;
      box-shadow: var(--shadow);
      transition: var(--transition);
      border: 1px solid var(--border);
    }
    
    .feature:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0,0,0,0.1);
    }
    
    .feature-icon {
      font-size: 2rem;
      margin-bottom: 15px;
      color: var(--primary);
    }
    
    .feature h3 {
      font-size: 1.1rem;
      margin-bottom: 8px;
      color: var(--dark);
    }
    
    .feature p {
      font-size: 0.9rem;
      color: var(--gray);
    }
    
    .card {
      background: white;
      padding: 30px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      margin-bottom: 25px;
      border: 1px solid var(--border);
    }
    
    .card-title {
      font-size: 1.4rem;
      margin-bottom: 20px;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .card-title i {
      color: var(--primary);
    }
    
    label {
      display: block;
      margin: 15px 0 8px;
      font-weight: 600;
      color: var(--dark);
    }
    
    input, textarea {
      width: 100%;
      padding: 14px;
      border: 2px solid var(--border);
      border-radius: 10px;
      font-size: 16px;
      font-family: inherit;
      transition: var(--transition);
      background-color: white;
    }
    
    input:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    textarea {
      min-height: 150px;
      resize: vertical;
      line-height: 1.6;
    }
    
    .password-container {
      position: relative;
    }
    
    .toggle-password {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--gray);
      cursor: pointer;
      padding: 5px;
      font-size: 1.2rem;
    }
    
    .password-strength {
      height: 6px;
      border-radius: 5px;
      margin-top: 10px;
      background-color: #e2e8f0;
      overflow: hidden;
    }
    
    .strength-meter {
      height: 100%;
      width: 0%;
      transition: width 0.5s ease;
    }
    
    .strength-weak { background-color: #ef4444; }
    .strength-medium { background-color: #f59e0b; }
    .strength-good { background-color: #3b82f6; }
    .strength-strong { background-color: #10b981; }
    
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      background: var(--primary);
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      margin: 10px 5px;
      transition: var(--transition);
      min-width: 160px;
    }
    
    .btn:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
    }
    
    .btn-secondary {
      background: var(--secondary);
    }
    
    .btn-secondary:hover {
      background: var(--secondary-dark);
      box-shadow: 0 10px 20px rgba(220, 38, 38, 0.3);
    }
    
    .btn-outline {
      background: white;
      color: var(--primary);
      border: 2px solid var(--primary);
    }
    
    .btn-outline:hover {
      background: var(--primary);
      color: white;
    }
    
    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 25px;
    }
    
    .result-box {
      background: #f1f5f9;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      font-family: 'Courier New', monospace;
      white-space: pre-wrap;
      word-break: break-word;
      direction: ltr;
      text-align: left;
      border-left: 4px solid var(--primary);
      display: none;
    }
    
    .link-display {
      background: #eff6ff;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      word-break: break-all;
      border: 2px dashed var(--primary);
      position: relative;
      font-family: monospace;
      font-size: 14px;
      line-height: 1.5;
    }
    
    .copy-btn {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: var(--transition);
    }
    
    .copy-btn:hover {
      background: var(--primary-dark);
      transform: translateY(-50%) scale(1.05);
    }
    
    .message-info {
      background: #fff8e6;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border-right: 4px solid var(--warning);
      font-size: 15px;
    }
    
    .message-info i {
      color: var(--warning);
      margin-left: 8px;
    }
    
    .security-info {
      background: #f0f9ff;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border-right: 4px solid var(--primary);
      font-size: 15px;
    }
    
    .alert {
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      font-weight: 600;
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .alert-success {
      background-color: #d1fae5;
      color: #065f46;
      border-right: 4px solid var(--success);
    }
    
    .alert-error {
      background-color: #fee2e2;
      color: #991b1b;
      border-right: 4px solid var(--secondary);
    }
    
    .footer {
      text-align: center;
      margin-top: 40px;
      padding: 25px;
      color: var(--gray);
      font-size: 0.9rem;
      border-top: 1px solid var(--border);
    }
    
    .progress-bar {
      height: 8px;
      background-color: #e2e8f0;
      border-radius: 4px;
      margin: 20px 0;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), #60a5fa);
      width: 0%;
      transition: width 0.5s ease;
    }
    
    .hidden {
      display: none;
    }
    
    .visible {
      display: block;
    }
    
    .char-count {
      text-align: left;
      font-size: 0.9rem;
      color: var(--gray);
      margin-top: 5px;
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      .card {
        padding: 20px;
      }
      
      .button-group {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
        margin: 5px 0;
      }
      
      .features-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <i class="fas fa-shield-alt logo-icon"></i>
        <div>
          <h1>ğŸ”’ Ø¢Ù…Ù† - Ù…Ø±Ø§Ø³Ù„Ø© Ù…Ø´ÙØ±Ø© Ø·Ø±ÙÙŠÙ‹Ø§</h1>
          <p class="subtitle">Ø±Ø³Ø§Ø¦Ù„ Ù…Ø´ÙØ±Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ â€¢ Ù„Ø§ ØªØµÙ„ Ù„Ù„Ø®ÙˆØ§Ø¯Ù… â€¢ ØªØ­Ø°Ù ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§</p>
        </div>
      </div>
      <p class="motto">"Ø¥Ù…Ø§ Ø­ÙŠØ§Ø© ØªØ³Ø± Ø§Ù„ØµØ¯ÙŠÙ‚ ÙˆØ¥Ù…Ø§ Ù…Ù…Ø§Øª ÙŠØºÙŠØ¸ Ø§Ù„Ø¹Ø¯Ø§"</p>
    </header>
    
    <div class="features-grid">
      <div class="feature">
        <i class="fas fa-user-shield feature-icon"></i>
        <h3>Ø®ØµÙˆØµÙŠØ© ÙƒØ§Ù…Ù„Ø©</h3>
        <p>Ø§Ù„ØªØ´ÙÙŠØ± Ø·Ø±ÙÙŠ ÙˆÙ„Ø§ ÙŠØ®Ø²Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ±ÙØ±</p>
      </div>
      <div class="feature">
        <i class="fas fa-clock feature-icon"></i>
        <h3>Ù…Ø­Ø¯ÙˆØ¯ÙŠØ© Ø§Ù„ÙˆÙ‚Øª</h3>
        <p>Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØªØ®ØªÙÙŠ Ø¨Ø¹Ø¯ ÙØªØ±Ø© Ø²Ù…Ù†ÙŠØ©</p>
      </div>
      <div class="feature">
        <i class="fas fa-key feature-icon"></i>
        <h3>ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ù‚ÙˆÙŠØ©</h3>
        <p>ØªØ´ÙÙŠØ± AES-256 Ø¨Ù…ÙØªØ§Ø­ Ù…Ø´ØªÙ‚ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</p>
      </div>
      <div class="feature">
        <i class="fas fa-share-alt feature-icon"></i>
        <h3>Ù…Ø´Ø§Ø±ÙƒØ© Ø¢Ù…Ù†Ø©</h3>
        <p>Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ QR ÙƒÙˆØ¯</p>
      </div>
    </div>
    
    <div class="message-info">
      <i class="fas fa-info-circle"></i>
      <strong>ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ØŸ</strong><br>
      1. Ø§ØªÙÙ‚ Ù…Ø¹ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø¢Ø®Ø± Ø¹Ù„Ù‰ <strong>ÙƒÙ„Ù…Ø© Ø³Ø± Ø³Ø±ÙŠØ©</strong> (Ù…Ø«Ù„: "MySecretKey!2026").<br>
      2. Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ â†’ Ø§Ø¶ØºØ· "ØªØ´ÙÙŠØ±" â†’ Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·.<br>
      3. Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„ØµØ¯ÙŠÙ‚Ùƒ.<br>
      4. ÙŠØ¯Ø®Ù„ Ù†ÙØ³ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·.
    </div>
    
    <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ´ÙÙŠØ± -->
    <div class="card">
      <h3 class="card-title"><i class="fas fa-lock"></i> ØªØ´ÙÙŠØ± ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø·</h3>
      
      <div class="progress-bar">
        <div class="progress-fill" id="encryptProgress"></div>
      </div>
      
      <label for="senderName"><i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø³Ù„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
      <input type="text" id="senderName" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù„ÙŠ" value="">
      
      <label for="message"><i class="fas fa-envelope"></i> Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³Ø±ÙŠØ©:</label>
      <textarea id="message" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ø§Ù„Ø³Ø±ÙŠØ© Ù‡Ù†Ø§... (ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©)"></textarea>
      <div class="char-count" id="charCount">0 Ø­Ø±Ù</div>
      
      <label for="password"><i class="fas fa-key"></i> ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø³Ø±ÙŠØ©:</label>
      <div class="password-container">
        <input type="password" id="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø³Ø± Ù‚ÙˆÙŠØ© (8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)">
        <button type="button" class="toggle-password" id="togglePassword">
          <i class="far fa-eye"></i>
        </button>
      </div>
      <div class="password-strength">
        <div class="strength-meter" id="passwordStrength"></div>
      </div>
      
      <div class="button-group">
        <button class="btn" onclick="encryptAndShare()" id="encryptBtn">
          <i class="fas fa-lock"></i> ØªØ´ÙÙŠØ± ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø·
        </button>
        <button class="btn btn-outline" onclick="resetForm()">
          <i class="fas fa-redo"></i> Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        </button>
      </div>
      
      <div id="linkContainer" class="hidden">
        <div class="alert alert-success">
          <i class="fas fa-check-circle"></i> ØªÙ… ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­! 
        </div>
        
        <label><i class="fas fa-link"></i> Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´ÙØ±:</label>
        <div class="link-display">
          <span id="shareLink"></span>
          <button class="copy-btn" onclick="copyToClipboard()">
            <i class="far fa-copy"></i> Ù†Ø³Ø®
          </button>
        </div>
        
        <div class="button-group">
          <button class="btn btn-outline" onclick="shareViaWhatsApp()">
            <i class="fab fa-whatsapp"></i> Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨
          </button>
          <button class="btn btn-outline" onclick="shareViaTelegram()">
            <i class="fab fa-telegram"></i> Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…
          </button>
        </div>
      </div>
    </div>
    
    <!-- Ù‚Ø³Ù… ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± -->
    <div class="card" id="decryptSection" style="display:none;">
      <h3 class="card-title"><i class="fas fa-unlock"></i> ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø©</h3>
      
      <div id="messageInfo" class="security-info">
        <i class="fas fa-shield-alt"></i>
        <span id="messageMeta">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø©...</span>
      </div>
      
      <label for="decryptPassword"><i class="fas fa-key"></i> Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±:</label>
      <div class="password-container">
        <input type="password" id="decryptPassword" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„ØªÙŠ Ø§ØªÙÙ‚Øª Ø¹Ù„ÙŠÙ‡Ø§ Ù…Ø¹ Ø§Ù„Ù…Ø±Ø³Ù„">
        <button type="button" class="toggle-password" id="toggleDecryptPassword">
          <i class="far fa-eye"></i>
        </button>
      </div>
      
      <div class="button-group">
        <button class="btn btn-secondary" onclick="decryptMessage()" id="decryptBtn">
          <i class="fas fa-unlock-alt"></i> Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        </button>
        <button class="btn btn-outline" onclick="clearDecryption()">
          <i class="fas fa-times"></i> Ù…Ø³Ø­
        </button>
      </div>
      
      <div id="output" class="result-box"></div>
    </div>
    
    <div class="security-info">
      <i class="fas fa-shield-alt"></i>
      <strong>Ù†Ù‚Ø§Ø· Ø§Ù„Ø£Ù…Ø§Ù†:</strong><br>
      â€¢ ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ØªØ´ÙÙŠØ± AES-256-GCM (Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„Ø¹Ø¨Ø«).<br>
      â€¢ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø§ ØªØªØ±Ùƒ Ø§Ù„Ù…ØªØµÙØ­ ÙˆÙ„Ø§ ØªØ±Ø³Ù„ Ù„Ù„Ø®ÙˆØ§Ø¯Ù….<br>
      â€¢ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø© ÙÙ‚Ø· Ù‡ÙŠ Ø§Ù„ØªÙŠ ØªÙØ´Ø§Ø±Ùƒ Ø¹Ø¨Ø± Ø§Ù„Ø±Ø§Ø¨Ø·.<br>
      â€¢ ÙŠÙ…ÙƒÙ† ØªØ¯Ù…ÙŠØ± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¨Ø¹Ø¯ Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ø£Ùˆ Ø¨Ø¹Ø¯ ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯.
    </div>
    
    <footer class="footer">
      <p>ğŸ›¡ï¸ <strong>Ø¢Ù…Ù†</strong> - Ù…Ø±Ø§Ø³Ù„Ø© Ù…Ø´ÙØ±Ø© Ø·Ø±ÙÙŠÙ‹Ø§ | Ø§Ù„Ø¥ØµØ¯Ø§Ø± 2.0</p>
      <p style="margin-top: 10px; font-size: 0.8rem;">
        ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ù…Ø¹Ø§ÙŠÙŠØ± Ø£Ù…Ø§Ù† Ø¹Ø§Ù„ÙŠØ© | Ø§Ù„ØªØ´ÙÙŠØ± ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Web Crypto API
      </p>
    </footer>
  </div>

  <script>
    // =============== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ´ÙÙŠØ± ===============
    const uint8ToBase64 = (buffer) => {
      const bytes = new Uint8Array(buffer);
      let binary = '';
      for (let i = 0; i < bytes.byteLength; i++) {
        binary += String.fromCharCode(bytes[i]);
      }
      return btoa(binary);
    };

    const base64ToUint8 = (base64) => {
      const binaryString = atob(base64);
      const bytes = new Uint8Array(binaryString.length);
      for (let i = 0; i < binaryString.length; i++) {
        bytes[i] = binaryString.charCodeAt(i);
      }
      return bytes;
    };

    // =============== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ===============
    document.addEventListener('DOMContentLoaded', function() {
      // Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ¨Ø¯ÙŠÙ„ Ø±Ø¤ÙŠØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
      document.getElementById('togglePassword').addEventListener('click', function() {
        const passwordInput = document.getElementById('password');
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          icon.className = 'far fa-eye-slash';
        } else {
          passwordInput.type = 'password';
          icon.className = 'far fa-eye';
        }
      });

      document.getElementById('toggleDecryptPassword').addEventListener('click', function() {
        const passwordInput = document.getElementById('decryptPassword');
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          icon.className = 'far fa-eye-slash';
        } else {
          passwordInput.type = 'password';
          icon.className = 'far fa-eye';
        }
      });

      // Ù…ØªØ§Ø¨Ø¹Ø© Ø¹Ø¯Ø¯ Ø£Ø­Ø±Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø©
      document.getElementById('message').addEventListener('input', function() {
        const count = this.value.length;
        document.getElementById('charCount').textContent = `${count} Ø­Ø±Ù`;
        
        // ØªØ­Ø³ÙŠÙ† Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        checkPasswordStrength();
      });

      // Ù…ØªØ§Ø¨Ø¹Ø© Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
      document.getElementById('password').addEventListener('input', checkPasswordStrength);

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø±Ø³Ø§Ù„Ø© Ù…Ø´ÙØ±Ø© ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has('msg')) {
        document.getElementById('decryptSection').style.display = 'block';
        document.getElementById('decryptPassword').focus();
        
        // Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù… Ø§Ù„ØªØ´ÙÙŠØ±
        document.querySelector('.card:nth-child(4)').style.display = 'none';
        
        try {
          const encryptedParam = urlParams.get('msg');
          document.getElementById('messageMeta').innerHTML = 
            '<i class="fas fa-envelope"></i> Ø±Ø³Ø§Ù„Ø© Ù…Ø´ÙØ±Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„ÙØªØ­';
        } catch (e) {
          console.log('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©');
        }
      }
    });

    // =============== ÙØ­Øµ Ù‚ÙˆØ© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ===============
    function checkPasswordStrength() {
      const password = document.getElementById('password').value;
      const strengthMeter = document.getElementById('passwordStrength');
      
      if (!password) {
        strengthMeter.style.width = '0%';
        return;
      }

      let score = 0;
      
      // Ø·ÙˆÙ„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
      if (password.length >= 8) score += 25;
      if (password.length >= 12) score += 10;
      
      // ØªÙ†ÙˆØ¹ Ø§Ù„Ø£Ø­Ø±Ù
      if (/[A-Z]/.test(password)) score += 15;
      if (/[a-z]/.test(password)) score += 15;
      if (/[0-9]/.test(password)) score += 15;
      if (/[^A-Za-z0-9]/.test(password)) score += 20;

      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
      const percent = Math.min(score, 100);
      strengthMeter.style.width = percent + '%';
      
      if (percent < 30) {
        strengthMeter.className = 'strength-meter strength-weak';
      } else if (percent < 60) {
        strengthMeter.className = 'strength-meter strength-medium';
      } else if (percent < 80) {
        strengthMeter.className = 'strength-meter strength-good';
      } else {
        strengthMeter.className = 'strength-meter strength-strong';
      }
    }

    // =============== Ø§Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ===============
    async function encryptAndShare() {
      const sender = document.getElementById('senderName').value.trim() || 'Ù…Ø±Ø³ÙÙ„ Ù…Ø¬Ù‡ÙˆÙ„';
      const message = document.getElementById('message').value.trim();
      const password = document.getElementById('password').value;

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
      if (!message) {
        showAlert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹.', 'error');
        document.getElementById('message').focus();
        return;
      }

      if (!password) {
        showAlert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±.', 'error');
        document.getElementById('password').focus();
        return;
      }

      if (password.length < 8) {
        showAlert('âš ï¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.', 'error');
        return;
      }

      const encryptBtn = document.getElementById('encryptBtn');
      const originalText = encryptBtn.innerHTML;
      encryptBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ÙÙŠØ±...';
      encryptBtn.disabled = true;

      try {
        // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
        document.getElementById('encryptProgress').style.width = '30%';
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Øµ Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
        const fullText = `ğŸ‘¤ Ø§Ù„Ù…Ø±Ø³Ù„: ${sender}\nğŸ“… Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleString('ar-SA')}\n\n${message}\n\n---\nğŸ” ØªÙ… Ø§Ù„ØªØ´ÙÙŠØ± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… "Ø¢Ù…Ù†"`;
        
        document.getElementById('encryptProgress').style.width = '50%';

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ bytes
        const encoder = new TextEncoder();
        const data = encoder.encode(fullText);

        // Ø¥Ù†Ø´Ø§Ø¡ salt Ùˆ iv Ø¹Ø´ÙˆØ§Ø¦ÙŠÙŠÙ†
        const salt = crypto.getRandomValues(new Uint8Array(16));
        const iv = crypto.getRandomValues(new Uint8Array(12));

        // Ø§Ø´ØªÙ‚Ø§Ù‚ Ø§Ù„Ù…ÙØªØ§Ø­ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        const keyMaterial = await crypto.subtle.importKey(
          "raw",
          encoder.encode(password),
          { name: "PBKDF2" },
          false,
          ["deriveKey"]
        );

        document.getElementById('encryptProgress').style.width = '70%';

        const aesKey = await crypto.subtle.deriveKey(
          {
            name: "PBKDF2",
            salt: salt,
            iterations: 210000,
            hash: "SHA-256"
          },
          keyMaterial,
          { name: "AES-GCM", length: 256 },
          false,
          ["encrypt"]
        );

        // ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const encryptedData = await crypto.subtle.encrypt(
          {
            name: "AES-GCM",
            iv: iv
          },
          aesKey,
          data
        );

        document.getElementById('encryptProgress').style.width = '90%';

        // Ø¯Ù…Ø¬ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: salt + iv + Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©
        const combined = new Uint8Array(salt.length + iv.length + encryptedData.byteLength);
        combined.set(salt, 0);
        combined.set(iv, salt.length);
        combined.set(new Uint8Array(encryptedData), salt.length + iv.length);

        // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Base64
        const encryptedB64 = btoa(String.fromCharCode(...combined));
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø·
        const urlSafe = encodeURIComponent(encryptedB64);
        const fullUrl = `${window.location.origin}${window.location.pathname}?msg=${urlSafe}`;

        // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø§Ø¨Ø·
        document.getElementById('shareLink').textContent = fullUrl;
        document.getElementById('linkContainer').classList.remove('hidden');
        
        document.getElementById('encryptProgress').style.width = '100%';

        // Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        setTimeout(() => {
          copyToClipboard();
        }, 500);

        showAlert('âœ… ØªÙ… ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!', 'success');

      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ÙÙŠØ±:', error);
        showAlert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ´ÙÙŠØ±: ' + error.message, 'error');
      } finally {
        encryptBtn.innerHTML = originalText;
        encryptBtn.disabled = false;
        setTimeout(() => {
          document.getElementById('encryptProgress').style.width = '0%';
        }, 1000);
      }
    }

    // =============== ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± ===============
    async function decryptMessage() {
      const urlParams = new URLSearchParams(window.location.search);
      const encryptedParam = urlParams.get('msg');
      const password = document.getElementById('decryptPassword').value;

      if (!encryptedParam) {
        showAlert('âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ù„Ø© Ù…Ø´ÙØ±Ø© ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·.', 'error');
        return;
      }

      if (!password) {
        showAlert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±.', 'error');
        return;
      }

      const decryptBtn = document.getElementById('decryptBtn');
      const originalText = decryptBtn.innerHTML;
      decryptBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±...';
      decryptBtn.disabled = true;

      try {
        // ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·
        const encryptedB64 = decodeURIComponent(encryptedParam);
        const combined = base64ToUint8(encryptedB64);

        if (combined.length < 28) {
          throw new Error("Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´ÙØ±Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©.");
        }

        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ salt Ùˆ iv Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©
        const salt = combined.slice(0, 16);
        const iv = combined.slice(16, 28);
        const encryptedData = combined.slice(28);

        const encoder = new TextEncoder();

        // Ø§Ø´ØªÙ‚Ø§Ù‚ Ø§Ù„Ù…ÙØªØ§Ø­ Ù…Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
        const keyMaterial = await crypto.subtle.importKey(
          "raw",
          encoder.encode(password),
          { name: "PBKDF2" },
          false,
          ["deriveKey"]
        );

        const aesKey = await crypto.subtle.deriveKey(
          {
            name: "PBKDF2",
            salt: salt,
            iterations: 210000,
            hash: "SHA-256"
          },
          keyMaterial,
          { name: "AES-GCM", length: 256 },
          false,
          ["decrypt"]
        );

        // ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const decryptedData = await crypto.subtle.decrypt(
          {
            name: "AES-GCM",
            iv: iv
          },
          aesKey,
          encryptedData
        );

        const decoder = new TextDecoder();
        const plaintext = decoder.decode(decryptedData);

        // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        document.getElementById('output').innerHTML = plaintext;
        document.getElementById('output').style.display = 'block';
        document.getElementById('output').classList.add('visible');

        showAlert('âœ… ØªÙ… ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');

      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±:', error);
        document.getElementById('output').innerHTML = 
          '<div class="alert alert-error"><i class="fas fa-exclamation-triangle"></i> âŒ ÙØ´Ù„ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±! ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØµØ­ÙŠØ­Ø©.</div>';
        document.getElementById('output').style.display = 'block';
        document.getElementById('output').classList.add('visible');
      } finally {
        decryptBtn.innerHTML = originalText;
        decryptBtn.disabled = false;
      }
    }

    // =============== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ===============
    function copyToClipboard() {
      const link = document.getElementById('shareLink').textContent;
      
      navigator.clipboard.writeText(link).then(() => {
        const copyBtn = document.querySelector('.copy-btn');
        const originalHtml = copyBtn.innerHTML;
        copyBtn.innerHTML = '<i class="fas fa-check"></i> ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
        copyBtn.style.background = 'var(--success)';
        
        setTimeout(() => {
          copyBtn.innerHTML = originalHtml;
          copyBtn.style.background = 'var(--primary)';
        }, 2000);
      }).catch(err => {
        console.error('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®:', err);
        showAlert('âŒ ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·', 'error');
      });
    }

    function shareViaWhatsApp() {
      const link = document.getElementById('shareLink').textContent;
      const text = `Ø±Ø³Ø§Ù„Ø© Ø³Ø±ÙŠØ© Ù…Ø´ÙØ±Ø© ğŸ”\n\n${link}\n\nØ§Ø³ØªØ®Ø¯Ù… ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§ Ù„ÙØªØ­ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.`;
      const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
      window.open(url, '_blank');
    }

    function shareViaTelegram() {
      const link = document.getElementById('shareLink').textContent;
      const text = `Ø±Ø³Ø§Ù„Ø© Ø³Ø±ÙŠØ© Ù…Ø´ÙØ±Ø© ğŸ”\n\n${link}\n\nØ§Ø³ØªØ®Ø¯Ù… ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§ Ù„ÙØªØ­ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.`;
      const url = `https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`;
      window.open(url, '_blank');
    }

    function resetForm() {
      document.getElementById('senderName').value = '';
      document.getElementById('message').value = '';
      document.getElementById('password').value = '';
      document.getElementById('charCount').textContent = '0 Ø­Ø±Ù';
      document.getElementById('passwordStrength').style.width = '0%';
      document.getElementById('linkContainer').classList.add('hidden');
      document.getElementById('encryptProgress').style.width = '0%';
      document.getElementById('message').focus();
    }

    function clearDecryption() {
      document.getElementById('decryptPassword').value = '';
      document.getElementById('output').style.display = 'none';
      document.getElementById('output').innerHTML = '';
    }

    function showAlert(message, type) {
      // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
      const existingAlert = document.querySelector('.alert:not(.alert-success):not(.alert-error)');
      if (existingAlert) {
        existingAlert.remove();
      }

      // Ø¥Ù†Ø´Ø§Ø¡ ØªÙ†Ø¨ÙŠÙ‡ Ø¬Ø¯ÙŠØ¯
      const alertDiv = document.createElement('div');
      alertDiv.className = `alert alert-${type}`;
      alertDiv.innerHTML = message;
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ù‚Ø¨Ù„ Ù‚Ø³Ù… Ø§Ù„ØªØ´ÙÙŠØ±
      const encryptCard = document.querySelector('.card:nth-child(4)');
      encryptCard.parentNode.insertBefore(alertDiv, encryptCard);
      
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
      setTimeout(() => {
        if (alertDiv.parentNode) {
          alertDiv.style.opacity = '0';
          alertDiv.style.transition = 'opacity 0.5s ease';
          setTimeout(() => {
            if (alertDiv.parentNode) {
              alertDiv.parentNode.removeChild(alertDiv);
            }
          }, 500);
        }
      }, 5000);
    }
  </script>
</body>
</html>

